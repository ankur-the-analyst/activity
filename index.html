items-center text-lg text-gray-800">
                            <span>Proctoring Violations (Total):</span>
                            <span class="font-bold text-red-700">${proctoringViolations.total}</span>
                        </div>
                        <div class="flex justify-between items-center text-md text-gray-700 mt-2 pt-2 border-t border-gray-200">
                            <span>- Tab/Window Switch:</span>
                            <span class="font-semibold text-red-600">${proctoringViolations.windowSwitch}</span>
                        </div>
                        <div class="flex justify-between items-center text-md text-gray-700">
                            <span>- Copy/Paste Attempt:</span>
                            <span class="font-semibold text-red-600">${proctoringViolations.copyPaste}</span>
                        </div>
                    </div>

                    <button onclick="setView('signin')" class="w-full py-3 px-4 border border-transparent rounded-lg shadow-md text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150 ease-in-out">
                        Return to Sign-In
                    </button>
                </div>
            `;
        }

        function renderAdminLogin() {
            APP_CONTAINER.className = "flex items-center justify-center min-h-screen p-4 bg-gray-50";
            APP_CONTAINER.innerHTML = `
                <div class="w-full max-w-sm bg-white rounded-xl shadow-xl p-8">
                    <h2 class="text-2xl font-bold text-center text-gray-900 mb-6"><i class="fas fa-user-shield mr-2 text-red-600"></i>Admin Login</h2>
                    <p class="text-center text-gray-500 text-sm mb-4">Credentials: ID: <strong>admin</strong> | Pass: <strong>admin123</strong></p>
                    <form id="adminLoginForm" class="space-y-4">
                        <div>
                            <label for="adminId" class="block text-sm font-medium text-gray-700">Admin ID</label>
                            <input type="text" id="adminId" required class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-red-500 focus:border-red-500">
                        </div>
                        <div>
                            <label for="adminPassword" class="block text-sm font-medium text-gray-700">Password</label>
                            <input type="password" id="adminPassword" required class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-red-500 focus:border-red-500">
                        </div>
                        <button type="submit" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition duration-150 ease-in-out mt-6">
                            Login
                        </button>
                        <button type="button" onclick="setView('signin')" class="w-full mt-2 py-2 px-4 rounded-lg text-sm font-medium text-gray-600 border border-gray-300 hover:bg-gray-100 transition duration-150 ease-in-out">
                            Back to Home
                        </button>
                    </form>
                </div>
            `;

            document.getElementById('adminLoginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const id = document.getElementById('adminId').value;
                const password = document.getElementById('adminPassword').value;

                if (id === 'admin' && password === 'admin123') {
                    setView('leaderboard');
                } else {
                    const loginMessage = document.createElement('p');
                    loginMessage.className = 'text-sm text-red-500 mt-2 text-center';
                    loginMessage.textContent = 'Invalid Admin ID or Password.';
                    document.getElementById('adminLoginForm').appendChild(loginMessage);
                    setTimeout(() => loginMessage.remove(), 3000);
                }
            });
        }

        async function renderLeaderboard() {
            APP_CONTAINER.className = "flex items-start justify-center min-h-screen p-4 bg-gray-100";

            APP_CONTAINER.innerHTML = `
                <div class="w-full max-w-5xl bg-white rounded-2xl shadow-xl p-8 mt-10">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-3xl font-bold text-gray-900"><i class="fas fa-trophy mr-2 text-yellow-500"></i>Real-Time Leaderboard (Admin View)</h2>
                        <button onclick="setView('signin')" class="px-4 py-2 rounded-lg text-sm font-medium text-blue-600 border border-blue-600 hover:bg-blue-50 transition duration-150">
                            Return Home
                        </button>
                    </div>

                    <div class="text-center py-8">
                        <i class="fas fa-spinner fa-spin text-4xl text-blue-500"></i>
                        <p class="mt-4 text-gray-600">Loading leaderboard data...</p>
                    </div>
                </div>
            `;

            const leaderboard = await getLeaderboard();

            const tableRows = leaderboard.map((entry, index) => `
                <tr class="hover:bg-gray-50 ${index % 2 === 0 ? 'bg-white' : 'bg-gray-50'}">
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${index + 1}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${entry.student_name}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${entry.admission_no}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-bold text-green-700">${entry.score}/${entry.total_questions}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-bold ${entry.percentage >= 80 ? 'text-green-600' : entry.percentage >= 50 ? 'text-yellow-600' : 'text-red-600'}">${entry.percentage}%</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-red-500">${entry.total_violations} (W:${entry.window_switch_violations || 0}, C:${entry.copy_paste_violations || 0})</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${new Date(entry.created_at).toLocaleString()}</td>
                </tr>
            `).join('');

            const tableContent = tableRows.length > 0 ? tableRows : `<tr><td colspan="7" class="px-6 py-8 text-center text-gray-500 font-medium bg-white">No submissions have been recorded yet. The leaderboard is currently blank.</td></tr>`;

            APP_CONTAINER.innerHTML = `
                <div class="w-full max-w-5xl bg-white rounded-2xl shadow-xl p-8 mt-10">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-3xl font-bold text-gray-900"><i class="fas fa-trophy mr-2 text-yellow-500"></i>Real-Time Leaderboard (Admin View)</h2>
                        <button onclick="setView('signin')" class="px-4 py-2 rounded-lg text-sm font-medium text-blue-600 border border-blue-600 hover:bg-blue-50 transition duration-150">
                            Return Home
                        </button>
                    </div>

                    <div class="overflow-x-auto shadow border-b border-gray-200 sm:rounded-lg">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rank</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Admission No.</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Score</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Percentage</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Violations (W/C)</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Time</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                ${tableContent}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        document.addEventListener('DOMContentLoaded', () => {
            setView('signin');

            ADMIN_BUTTON.addEventListener('click', () => {
                setView('admin');
            });

            const fullScreenChangeHandler = () => {
                if (!document.fullscreenElement && !document.webkitFullscreenElement && !document.mozFullScreenElement && currentQuestionIndex < quizQuestions.length && VIOLATION_MODAL.style.display !== 'flex') {
                    handleProctoringViolation('windowSwitch');
                }
            };

            document.addEventListener('fullscreenchange', fullScreenChangeHandler);
            document.addEventListener('webkitfullscreenchange', fullScreenChangeHandler);
            document.addEventListener('mozfullscreenchange', fullScreenChangeHandler);
        });
    </script>
</body>
</html>
